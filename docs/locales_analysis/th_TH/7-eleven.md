# 7-Eleven (th_TH)

## Источник
- **Файл:** photo/photo_2_th/IMG_2461.jpeg
- **Дата анализа:** 2025-12-26
- **Дата чека:** 03/10/2568 (= 03/10/2025), 23:33

## Метаданные чека

| Поле | Значение |
|------|----------|
| Сеть | CP ALL |
| Магазин | 7-Eleven หม่อมไหม จุด 2 (09585) |
| TAX ID | 0107542000011 |
| Vat Code | 07437 |
| POS | E06770000201326 |
| Валюта | THB |
| Способ оплаты | เงินสด (Cash) |
| Получено | 1,000.00 |
| Сдача | 241.75 |
| Subtotal | 783.25 |
| Скидки | 25.00 |
| Net Total | 758.25 |
| Кол-во позиций | 22 ชิ้น |

## Структура чека

```
┌─────────────────────────────────────────┐
│ CP ALL, 7-Eleven หม่อมไหม จุด 2(09585)  │
│ TAX#0107542000011 (VAT Included)        │
│ Vat Code 07437 POS#E06770000201326      │
├─────────────────────────────────────────┤
│ ใบเสร็จรับเงิน/ใบกำกับภาษีอย่างย่อ          │
│ (Receipt/Simplified Tax Invoice)        │
├─────────────────────────────────────────┤
│ ITEMS (18 позиций)                      │
│ 1  โค้ก 1.45 ลิตร              36.00    │
│ 3  ผัดมักกะโรนีไก่  @37.00     111.00   │
│ ...                                     │
├─────────────────────────────────────────┤
│ ถลรวม                         783.25   │
├─────────────────────────────────────────┤
│ DISCOUNTS                               │
│ 1  ส่วนลดสเปรย์...             20.00    │
│ 1  ส่วนลดโจ๊ก...                5.00    │
├─────────────────────────────────────────┤
│ ถลสุทธิ 22 ชิ้น               758.25   │
│ เงินสด/เงินทอน 1,000.00       241.75   │
├─────────────────────────────────────────┤
│ R#00008... 03/10/68 23:33               │
│ ** ศูนย์ลูกค้าสัมพันธ์ 0-2826-7744 **    │
│ บิลนี้ประหยัด 25.00                      │
│ [QR код]                                │
└─────────────────────────────────────────┘
```

## Паттерны товарных строк

### Тип 1: Товар с множителем
```
Qty  Название                 @unit_price    Total
 3   ผัดมักกะโรนีไก่            @37.00        111.00
 2   ข้าวลูกน้ำหริกองเร้        @49.00         98.00
```
- Qty в НАЧАЛЕ строки
- Unit price с префиксом "@"
- Math: 3 * 37.00 = 111.00

### Тип 2: Простой товар (qty=1)
```
Qty  Название                              Total
 1   โค้ก 1.45 ลิตร                         36.00
 1   Hช็อกโกแลตลาวาเฟ่                      27.00
```
- Нет отдельного unit_price
- unit_price = total_price

### Тип 3: Бесплатные позиции (stamps)
```
Qty  Название                              Total
 9   แสตมป์ 1 บาท 2568                       0.00
 6   แสตมป์ 3 บาท 2568                       0.00
```
- Марки программы лояльности
- Цена 0.00
- Не влияют на итог

### Тип 4: Скидка (отдельный блок)
```
Qty  Название                              Total
 1   ส่วนลดสเปรย์กันยุงเวปวันพุช              20.00
 1   ส่วนลดโจ๊ก ต. (โทกน้ำทิพย์               5.00
```
- Ключевое слово: ส่วนลด (discount)
- **Показаны как положительные числа**
- Вычитаются из subtotal для получения net total

## Ground Truth таблица

| # | qty | raw_name | unit_price | total_price | is_discount |
|---|-----|----------|------------|-------------|-------------|
| 1 | 1 | โค้ก 1.45 ลิตร | 36.00 | 36.00 | false |
| 2 | 3 | ผัดมักกะโรนีไก่ | 37.00 | 111.00 | false |
| 3 | 2 | ข้าวลูกน้ำหริกองเร้ | 49.00 | 98.00 | false |
| 4 | 1 | Hช็อกโกแลตลาวาเฟ่ | 27.00 | 27.00 | false |
| 5 | 1 | Hแมพาสจเมจิ 450 | 29.00 | 29.00 | false |
| 6 | 1 | Hแมพาสจเมจิ 450 | 28.25 | 28.25 | false |
| 7 | 1 | แมเปรี้ยวUHTต้นบัล | 10.00 | 10.00 | false |
| 8 | 1 | เบอร์ลี้บาริสต้า เลส | 22.00 | 22.00 | false |
| 9 | 2 | Hแซนวิชปูอัดไข่กุ้ง E | 27.00 | 54.00 | false |
| 10 | 1 | แถมรสสดคริสเบอร์รี่ | 62.00 | 62.00 | false |
| 11 | 1 | Hเอถ์ดลาสติครสชาว | 32.00 | 32.00 | false |
| 12 | 1 | ทริปเปิ้ลมาการองคัพ | 45.00 | 45.00 | false |
| 13 | 1 | สเปรย์กันยุงเวปวันพู | 89.00 | 89.00 | false |
| 14 | 3 | อมอิ๋มลูกาจุ๊บส์ (ตอละ | 5.00 | 15.00 | false |
| 15 | 1 | Hเรดบูลเล็กซ์ดร้าแค | 15.00 | 15.00 | false |
| 16 | 1 | Hโอริโอ้ ไทท์ (เทค | 110.00 | 110.00 | false |
| 17 | 9 | แสตมป์ 1 บาท 2568 | 0.00 | 0.00 | false |
| 18 | 6 | แสตมป์ 3 บาท 2568 | 0.00 | 0.00 | false |
| 19 | 1 | ส่วนลดสเปรย์กันยุงเวปวันพุช | -20.00 | -20.00 | true |
| 20 | 1 | ส่วนลดโจ๊ก ต. (โทกน้ำทิพย์ | -5.00 | -5.00 | true |

**Примечание:** Скидки конвертированы в отрицательные значения для унификации с немецким форматом.

## Checksum валидация

### Проверка subtotal
```
Сумма товаров (без скидок):
36 + 111 + 98 + 27 + 29 + 28.25 + 10 + 22 + 54 + 62 + 
32 + 45 + 89 + 15 + 15 + 110 + 0 + 0 = 783.25

ถลรวม на чеке: 783.25 ✓
```

### Проверка скидок
```
Сумма скидок: 20 + 5 = 25.00
บิลนี้ประหยัด на чеке: 25.00 ✓
```

### Проверка net total
```
Net total: 783.25 - 25.00 = 758.25
ถลสุทธิ на чеке: 758.25 ✓
```

### Проверка сдачи
```
Сдача: 1000.00 - 758.25 = 241.75
เงินทอน на чеке: 241.75 ✓
```

**Расхождение: 0.00**

## Выводы для DTO товарной позиции

### Поля из этого чека:

| Поле | Присутствует | Пример | Комментарий |
|------|--------------|--------|-------------|
| raw_name | Да | "ผัดมักกะโรนีไก่" | Thai script |
| quantity | Да | 3 | Всегда целое число |
| unit | Нет | - | Только "штуки" (ชิ้น) |
| unit_price | Да (если qty>1) | 37.00 | С маркером "@" |
| total_price | Да | 111.00 | Всегда присутствует |
| tax_class | Нет | - | VAT included |
| is_discount | Да | true/false | Ключевое слово "ส่วนลด" |

### Особенности:
- **Нет весовых товаров** - только штучные
- **Нет tax_class** - VAT включен в цену
- **Скидки в отдельном блоке** - не рядом с товаром
- **Бесплатные позиции** (stamps) - цена 0.00

## Сравнение с de_DE/Lidl

| Аспект | de_DE/Lidl | th_TH/7-Eleven |
|--------|------------|----------------|
| Qty позиция | В конце | В начале |
| Unit price маркер | "x" | "@" |
| Десятичный разделитель | , | . |
| Tax block | Да | Нет |
| Весовые товары | Да | Нет |
| Скидки | После товара (-) | Отдельный блок (+) |
| Валидация | По tax block | По subtotal/net |

